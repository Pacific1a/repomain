# üöÄ –ù–ê–°–¢–†–û–ô–ö–ê PERSISTENT STORAGE –ù–ê RENDER

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!

**–ë–ï–ó –≠–¢–ò–• –ù–ê–°–¢–†–û–ï–ö –ë–ê–ó–ê –î–ê–ù–ù–´–• –ë–£–î–ï–¢ –°–ë–†–ê–°–´–í–ê–¢–¨–°–Ø!**

---

## üìã –®–ê–ì 1: –î–û–ë–ê–í–ò–¢–¨ PERSISTENT DISK

### 1. –û—Ç–∫—Ä–æ–π Render Dashboard

https://dashboard.render.com/

### 2. –ù–∞–π–¥–∏ —Å–µ—Ä–≤–∏—Å **duo-partner**

### 3. –ü–µ—Ä–µ–π–¥–∏ –≤ **Settings**

### 4. Scroll down ‚Üí –Ω–∞–π–¥–∏ —Ä–∞–∑–¥–µ–ª **Disks**

### 5. –ù–∞–∂–º–∏ **Add Disk**

### 6. –ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É:

```
Name: database
Mount Path: /opt/render/project/src/site/server/data
Size: 1 GB
```

**–í–ê–ñ–ù–û:** Mount Path –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¢–û–ß–ù–û —Ç–∞–∫–∏–º!

### 7. –ù–∞–∂–º–∏ **Create Disk**

### 8. –ü–æ–¥–æ–∂–¥–∏ ~1-2 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ –¥–∏—Å–∫ —Å–æ–∑–¥–∞—Å—Ç—Å—è

---

## üìã –®–ê–ì 2: –î–û–ë–ê–í–ò–¢–¨ ENVIRONMENT VARIABLE

### 1. –í —Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ **Settings**

### 2. Scroll down ‚Üí –Ω–∞–π–¥–∏ —Ä–∞–∑–¥–µ–ª **Environment Variables**

### 3. –ù–∞–∂–º–∏ **Add Environment Variable**

### 4. –ó–∞–ø–æ–ª–Ω–∏:

```
Key: DATABASE_PATH
Value: /opt/render/project/src/site/server/data/database.db
```

### 5. –ù–∞–∂–º–∏ **Save**

---

## üìã –®–ê–ì 3: MANUAL DEPLOY

### 1. –ü–µ—Ä–µ–π–¥–∏ –≤ —Ä–∞–∑–¥–µ–ª **Manual Deploy**

### 2. –ù–∞–∂–º–∏ **Clear build cache & deploy**

### 3. –ü–æ–¥–æ–∂–¥–∏ 2-3 –º–∏–Ω—É—Ç—ã –ø–æ–∫–∞ —Å–µ—Ä–≤–∏—Å –∑–∞–¥–µ–ø–ª–æ–∏—Ç—Å—è

### 4. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ (—Ä–∞–∑–¥–µ–ª **Logs**):

```
‚úÖ Connected to SQLite database at: /opt/render/project/src/site/server/data/database.db
üìÅ Created data directory: /opt/render/project/src/site/server/data
```

---

## üìã –®–ê–ì 4: –°–û–ó–î–ê–¢–¨ –ê–î–ú–ò–ù–ê

### –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –ß–µ—Ä–µ–∑ Shell (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)

1. –í Dashboard ‚Üí **Shell**
2. –í—ã–ø–æ–ª–Ω–∏:

```bash
cd /opt/render/project/src/site/server
node create-admin.js
```

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –õ–æ–∫–∞–ª—å–Ω–æ —Å DATABASE_PATH

1. –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ:

```powershell
cd "C:\Users\dev_fenomen\Desktop\duo\site\server"
$env:DATABASE_PATH="C:\Users\dev_fenomen\Desktop\duo\site\server\data\database.db"
node create-admin.js
```

2. –ó–∞–≥—Ä—É–∑–∏ database.db –Ω–∞ Render —á–µ—Ä–µ–∑ SFTP –∏–ª–∏ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–±

### –í–∞—Ä–∏–∞–Ω—Ç –í: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

1. POST –Ω–∞ https://duo-partner.onrender.com/api/register
2. –ü–æ—Ç–æ–º –æ–±–Ω–æ–≤–∏ —Ä–æ–ª—å —á–µ—Ä–µ–∑ SQL

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ß–¢–û –í–°–Å –†–ê–ë–û–¢–ê–ï–¢

### 1. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞

```
‚úÖ Connected to SQLite database at: /opt/render/project/src/site/server/data/database.db
```

**–ï–°–õ–ò –≤–∏–¥–∏—à—å:**
```
‚ùå Connected to SQLite database at: ./database.db
```
**–¢–û –ù–ê–°–¢–†–û–ô–ö–ê –ù–ï –ü–†–ò–ú–ï–ù–ò–õ–ê–°–¨!**

### 2. –°–æ–∑–¥–∞–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

1. –û—Ç–∫—Ä–æ–π https://duo-partner.onrender.com
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Å—è
3. –í–æ–π–¥–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç

### 3. –°–¥–µ–ª–∞–π Manual Deploy (REDEPLOY)

### 4. –ü–æ–ø—Ä–æ–±—É–π –≤–æ–π—Ç–∏ —Å–Ω–æ–≤–∞

**–ï–°–õ–ò:**
- ‚úÖ –í—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –ë–∞–∑–∞ persistent ‚úÖ
- ‚ùå 404 "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω" ‚Üí –ë–∞–∑–∞ –ù–ï persistent ‚ùå

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω" –ø–æ—Å–ª–µ —Ä–µ–¥–µ–ø–ª–æ—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ù–ï –Ω–∞ persistent disk

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ Disk —Å–æ–∑–¥–∞–Ω –≤ Settings ‚Üí Disks
2. –ü—Ä–æ–≤–µ—Ä—å Mount Path: `/opt/render/project/src/site/server/data`
3. –ü—Ä–æ–≤–µ—Ä—å Environment Variable: `DATABASE_PATH`
4. –†–µ–¥–µ–ø–ª–æ–π

### –ü—Ä–æ–±–ª–µ–º–∞: "Error opening database: SQLITE_CANTOPEN"

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–∞–ø–∫–∞ `/opt/render/project/src/site/server/data` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∫–æ–¥ —Å–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É (—Å—Ç—Ä–æ–∫–∞ 88-93 –≤ server.js)
2. –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–ø–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: clicks –≤—Å—ë –µ—â—ë –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –í –±–∞–∑–µ –Ω–µ—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞ —Å –Ω—É–∂–Ω—ã–º ID

**–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π –∞–¥–º–∏–Ω–∞ —á–µ—Ä–µ–∑ `create-admin.js`
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ –≤–µ–±
3. –ü—Ä–æ–≤–µ—Ä—å –≤ –ª–æ–≥–∞—Ö:

```
‚úÖ Partner found: id=1, telegram=1
‚úÖ Partner stats updated: clicks+1
```

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í –ù–ê RENDER

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):

```
/opt/render/project/src/site/server/
‚îú‚îÄ‚îÄ server.js
‚îú‚îÄ‚îÄ database.db  ‚Üê –í EPHEMERAL STORAGE! –£–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–¥–µ–ø–ª–æ–µ!
‚îú‚îÄ‚îÄ uploads/
‚îî‚îÄ‚îÄ ...
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ü–†–ê–í–ò–õ–¨–ù–û):

```
/opt/render/project/src/site/server/
‚îú‚îÄ‚îÄ server.js
‚îú‚îÄ‚îÄ data/  ‚Üê PERSISTENT DISK MOUNTED HERE!
‚îÇ   ‚îî‚îÄ‚îÄ database.db  ‚Üê –ù–ï —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–¥–µ–ø–ª–æ–µ! ‚úÖ
‚îú‚îÄ‚îÄ uploads/
‚îî‚îÄ‚îÄ ...
```

---

## üéØ –ö–û–ù–ï–ß–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:

‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤ persistent storage**  
‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ —Ä–µ–¥–µ–ø–ª–æ—è**  
‚úÖ **JWT —Ç–æ–∫–µ–Ω—ã –≤–∞–ª–∏–¥–Ω—ã –ø–æ—Å–ª–µ —Ä–µ–¥–µ–ø–ª–æ—è**  
‚úÖ **GET /api/user ‚Üí 200 OK**  
‚úÖ **GET /api/2fa/status ‚Üí 200 OK**  
‚úÖ **clicks –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ—Ö–æ–¥–µ**  
‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**  

**–í–°–Å –†–ê–ë–û–¢–ê–ï–¢ –ë–ï–ó –ü–û–¢–ï–†–ò –î–ê–ù–ù–´–•!** üöÄ

---

## üìù –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û

### –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞–π –±—ç–∫–∞–ø:

1. –í Shell:
```bash
cd /opt/render/project/src/site/server/data
cp database.db database_backup_$(date +%Y%m%d).db
```

2. –ò–ª–∏ —Å–∫–∞—á–∞–π —á–µ—Ä–µ–∑ SFTP

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞

–ü—Ä–æ–≤–µ—Ä—è–π —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã:

```bash
ls -lh /opt/render/project/src/site/server/data/database.db
```

–ï—Å–ª–∏ > 900 MB ‚Üí –Ω—É–∂–µ–Ω –±–æ–ª—å—à–∏–π –¥–∏—Å–∫!

---

**–ß–ò–¢–ê–ô:** `DATABASE_PROBLEM_ANALYSIS.md` ‚Üí **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–π Render** ‚Üí **–¢–µ—Å—Ç–∏—Ä—É–π!** ‚ú®

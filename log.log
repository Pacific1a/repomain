root@duos:/var/www/duo# pm2 stop duo-bot
[PM2] Applying action stopProcessId on app [duo-bot](ids: [ 7 ])
[PM2] [duo-bot](7) ✓
┌────┬───────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name              │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼───────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 7  │ duo-bot           │ default     │ N/A     │ fork    │ N/A      │ 0      │ 62   │ stopped   │ 0%       │ 0b       │ root     │ disabled │
│ 0  │ duo-server        │ default     │ 2.0.0   │ fork    │ 1070295  │ 55m    │ 271  │ online    │ 0%       │ 79.9mb   │ root     │ disabled │
│ 3  │ withdrawal-bot    │ default     │ 1.0.0   │ fork    │ 978415   │ 4D     │ 14   │ online    │ 0%       │ 63.6mb   │ root     │ disabled │
└────┴───────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
root@duos:/var/www/duo#  cd /var/www/duo/bot/autoshop
root@duos:/var/www/duo/bot/autoshop# python3 -m venv venv
root@duos:/var/www/duo/bot/autoshop#  source venv/bin/activate
(venv) root@duos:/var/www/duo/bot/autoshop#      pip install --upgrade pip
Requirement already satisfied: pip in ./venv/lib/python3.12/site-packages (24.0)
Collecting pip
  Using cached pip-25.3-py3-none-any.whl.metadata (4.7 kB)
Using cached pip-25.3-py3-none-any.whl (1.8 MB)

Installing collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 24.0
    Uninstalling pip-24.0:
      Successfully uninstalled pip-24.0
Successfully installed pip-25.3
(venv) root@duos:/var/www/duo/bot/autoshop#      pip install -r requirements.txt
Collecting aiogram==3.2.0 (from -r requirements.txt (line 1))
  Using cached aiogram-3.2.0-py3-none-any.whl.metadata (7.2 kB)
Collecting APScheduler==3.9.1 (from -r requirements.txt (line 2))
  Using cached APScheduler-3.9.1-py2.py3-none-any.whl.metadata (6.2 kB)
Collecting colorlog==6.7.0 (from -r requirements.txt (line 3))
  Using cached colorlog-6.7.0-py2.py3-none-any.whl.metadata (10 kB)
Collecting beautifulsoup4==4.10.0 (from -r requirements.txt (line 4))
  Using cached beautifulsoup4-4.10.0-py3-none-any.whl.metadata (3.5 kB)
Collecting aiohttp==3.9.1 (from -r requirements.txt (line 5))
  Using cached aiohttp-3.9.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (7.4 kB)
Collecting typing==3.7.4.3 (from -r requirements.txt (line 6))
  Using cached typing-3.7.4.3-py3-none-any.whl
Collecting colorama==0.4.5 (from -r requirements.txt (line 7))
  Using cached colorama-0.4.5-py2.py3-none-any.whl.metadata (15 kB)
Collecting bs4==0.0.1 (from -r requirements.txt (line 8))
  Using cached bs4-0.0.1-py3-none-any.whl
Collecting pytz==2022.6 (from -r requirements.txt (line 9))
  Using cached pytz-2022.6-py2.py3-none-any.whl.metadata (21 kB)
Collecting aiofiles==23.2.1 (from -r requirements.txt (line 10))
  Using cached aiofiles-23.2.1-py3-none-any.whl.metadata (9.7 kB)
Collecting pydantic==2.5.2 (from -r requirements.txt (line 11))
  Using cached pydantic-2.5.2-py3-none-any.whl.metadata (65 kB)
Collecting cachetools==4.2.4 (from -r requirements.txt (line 12))
  Using cached cachetools-4.2.4-py3-none-any.whl.metadata (4.8 kB)
Collecting certifi>=2023.7.22 (from aiogram==3.2.0->-r requirements.txt (line 1))
  Using cached certifi-2026.1.4-py3-none-any.whl.metadata (2.5 kB)
Collecting magic-filter<1.1,>=1.0.12 (from aiogram==3.2.0->-r requirements.txt (line 1))
  Using cached magic_filter-1.0.12-py3-none-any.whl.metadata (1.5 kB)
Collecting typing-extensions<=5.0,>=4.7.0 (from aiogram==3.2.0->-r requirements.txt (line 1))
  Using cached typing_extensions-4.15.0-py3-none-any.whl.metadata (3.3 kB)
Collecting attrs>=17.3.0 (from aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached attrs-25.4.0-py3-none-any.whl.metadata (10 kB)
Collecting multidict<7.0,>=4.5 (from aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached multidict-6.7.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (5.3 kB)
Collecting yarl<2.0,>=1.0 (from aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached yarl-1.22.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (75 kB)
Collecting frozenlist>=1.1.1 (from aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached frozenlist-1.8.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl.metadata (20 kB)
Collecting aiosignal>=1.1.2 (from aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached aiosignal-1.4.0-py3-none-any.whl.metadata (3.7 kB)
Collecting annotated-types>=0.4.0 (from pydantic==2.5.2->-r requirements.txt (line 11))
  Using cached annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
Collecting pydantic-core==2.14.5 (from pydantic==2.5.2->-r requirements.txt (line 11))
  Using cached pydantic_core-2.14.5-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.5 kB)
Collecting setuptools>=0.7 (from APScheduler==3.9.1->-r requirements.txt (line 2))
  Using cached setuptools-80.9.0-py3-none-any.whl.metadata (6.6 kB)
Collecting six>=1.4.0 (from APScheduler==3.9.1->-r requirements.txt (line 2))
  Using cached six-1.17.0-py2.py3-none-any.whl.metadata (1.7 kB)
Collecting tzlocal!=3.*,>=2.0 (from APScheduler==3.9.1->-r requirements.txt (line 2))
  Using cached tzlocal-5.3.1-py3-none-any.whl.metadata (7.6 kB)
Collecting soupsieve>1.2 (from beautifulsoup4==4.10.0->-r requirements.txt (line 4))
  Using cached soupsieve-2.8.1-py3-none-any.whl.metadata (4.6 kB)
Collecting idna>=2.0 (from yarl<2.0,>=1.0->aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached idna-3.11-py3-none-any.whl.metadata (8.4 kB)
Collecting propcache>=0.2.1 (from yarl<2.0,>=1.0->aiohttp==3.9.1->-r requirements.txt (line 5))
  Using cached propcache-0.4.1-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (13 kB)
WARNING: The candidate selected for download or install is a yanked version: 'apscheduler' candidate (version 3.9.1 at https://files.pythonhosted.org/packages/e4/9f/c3937d4babe62504b874d4bf2c0d85aa69c7f59fa84cf6050f3b9dc
5d83e/APScheduler-3.9.1-py2.py3-none-any.whl (from https://pypi.org/simple/apscheduler/) (requires-python:>=2.7, !=3.0.*, !=3.1.*, !=3.2.*, !=3.3.*, !=3.4.*, <4))
Reason for being yanked: Not compatible with Python 2.7
Using cached aiogram-3.2.0-py3-none-any.whl (470 kB)
Using cached aiohttp-3.9.1-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)
Using cached aiofiles-23.2.1-py3-none-any.whl (15 kB)
Using cached pydantic-2.5.2-py3-none-any.whl (381 kB)
Using cached APScheduler-3.9.1-py2.py3-none-any.whl (59 kB)
Using cached colorlog-6.7.0-py2.py3-none-any.whl (11 kB)
Using cached beautifulsoup4-4.10.0-py3-none-any.whl (97 kB)
Using cached colorama-0.4.5-py2.py3-none-any.whl (16 kB)
Using cached pytz-2022.6-py2.py3-none-any.whl (498 kB)
Using cached cachetools-4.2.4-py3-none-any.whl (10 kB)
Using cached pydantic_core-2.14.5-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.1 MB)
Using cached magic_filter-1.0.12-py3-none-any.whl (11 kB)
Using cached multidict-6.7.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (256 kB)
Using cached typing_extensions-4.15.0-py3-none-any.whl (44 kB)
Using cached yarl-1.22.0-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (377 kB)
Using cached aiosignal-1.4.0-py3-none-any.whl (7.5 kB)
Using cached annotated_types-0.7.0-py3-none-any.whl (13 kB)
Using cached attrs-25.4.0-py3-none-any.whl (67 kB)
Using cached certifi-2026.1.4-py3-none-any.whl (152 kB)
Using cached frozenlist-1.8.0-cp312-cp312-manylinux1_x86_64.manylinux_2_28_x86_64.manylinux_2_5_x86_64.whl (242 kB)
Using cached idna-3.11-py3-none-any.whl (71 kB)
Using cached propcache-0.4.1-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (221 kB)
Using cached setuptools-80.9.0-py3-none-any.whl (1.2 MB)
Using cached six-1.17.0-py2.py3-none-any.whl (11 kB)
Using cached soupsieve-2.8.1-py3-none-any.whl (36 kB)
Using cached tzlocal-5.3.1-py3-none-any.whl (18 kB)
Installing collected packages: pytz, tzlocal, typing-extensions, typing, soupsieve, six, setuptools, propcache, multidict, magic-filter, idna, frozenlist, colorlog, colorama, certifi, cachetools, attrs, annotated-types,
aiofiles, yarl, pydantic-core, beautifulsoup4, APScheduler, aiosignal, pydantic, bs4, aiohttp, aiogram
Successfully installed APScheduler-3.9.1 aiofiles-23.2.1 aiogram-3.2.0 aiohttp-3.9.1 aiosignal-1.4.0 annotated-types-0.7.0 attrs-25.4.0 beautifulsoup4-4.10.0 bs4-0.0.1 cachetools-4.2.4 certifi-2026.1.4 colorama-0.4.5 col
orlog-6.7.0 frozenlist-1.8.0 idna-3.11 magic-filter-1.0.12 multidict-6.7.0 propcache-0.4.1 pydantic-2.5.2 pydantic-core-2.14.5 pytz-2022.6 setuptools-80.9.0 six-1.17.0 soupsieve-2.8.1 typing-3.7.4.3 typing-extensions-4.1
5.0 tzlocal-5.3.1 yarl-1.22.0
(venv) root@duos:/var/www/duo/bot/autoshop#
(venv) root@duos:/var/www/duo/bot/autoshop#      # 4. Проверить что aiogram установлен
(venv) root@duos:/var/www/duo/bot/autoshop#      pip list | grep aiogram
aiogram           3.2.0
(venv) root@duos:/var/www/duo/bot/autoshop#  cat > ecosystem.config.js << 'EOF'
>      module.exports = {
>        apps: [{
>          name: 'duo-bot',
>          script: 'main.py',
>          interpreter: 'venv/bin/python3',
>          cwd: '/var/www/duo/bot/autoshop',
>          instances: 1,
>          autorestart: true,
>          watch: false,
>          max_memory_restart: '500M',
>          env: {
>            PYTHONUNBUFFERED: '1'
>          }
>        }]
>      }
> EOF
(venv) root@duos:/var/www/duo/bot/autoshop# pm2 start ecosystem.config.js
duo-bot --lines 50[PM2] Applying action restartProcessId on app [duo-bot](ids: [ 7 ])
[PM2] [duo-bot](7) ✓
┌────┬───────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name              │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼───────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 7  │ duo-bot           │ default     │ N/A     │ fork    │ 1075416  │ 0s     │ 62   │ online    │ 0%       │ 6.3mb    │ root     │ disabled │
│ 0  │ duo-server        │ default     │ 2.0.0   │ fork    │ 1070295  │ 55m    │ 271  │ online    │ 0%       │ 79.2mb   │ root     │ disabled │
│ 3  │ withdrawal-bot    │ default     │ 1.0.0   │ fork    │ 978415   │ 4D     │ 14   │ online    │ 0%       │ 63.9mb   │ root     │ disabled │
└────┴───────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘

(venv) root@duos:/var/www/duo/bot/autoshop#
(venv) root@duos:/var/www/duo/bot/autoshop#      # 7. Сохранить конфигурацию
(venv) root@duos:/var/www/duo/bot/autoshop#      pm2 save
[PM2] Saving current process list...
[PM2] Successfully saved in /root/.pm2/dump.pm2
(venv) root@duos:/var/www/duo/bot/autoshop#
(venv) root@duos:/var/www/duo/bot/autoshop#      # 8. Проверить логи
(venv) root@duos:/var/www/duo/bot/autoshop#      pm2 logs duo-bot --lines 50
[TAILING] Tailing last 50 lines for [duo-bot] process (change the value with --lines option)
/root/.pm2/logs/duo-bot-error-7.log last 50 lines:
7|duo-bot  | /var/www/duo/bot/autoshop/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_custom_emoji_id" has conflict with protected namespace "model_".
7|duo-bot  | 
7|duo-bot  | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
7|duo-bot  |   warnings.warn(
7|duo-bot  | /var/www/duo/bot/autoshop/venv/lib/python3.12/site-packages/apscheduler/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg
_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
7|duo-bot  |   from pkg_resources import get_distribution, DistributionNotFound
7|duo-bot  | WARNING | 14-01-2026 00:41:46 | main.py:59 | BOT WAS STARTED
7|duo-bot  | WARNING | 14-01-2026 00:48:42 | dispatcher.py:515 | Received SIGINT signal
7|duo-bot  | /var/www/duo/bot/autoshop/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_custom_emoji_id" has conflict with protected namespace "model_".
7|duo-bot  | 
7|duo-bot  | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
7|duo-bot  |   warnings.warn(
7|duo-bot  | /var/www/duo/bot/autoshop/venv/lib/python3.12/site-packages/apscheduler/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg
_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
7|duo-bot  |   from pkg_resources import get_distribution, DistributionNotFound
7|duo-bot  | WARNING | 14-01-2026 00:48:47 | main.py:59 | BOT WAS STARTED
7|duo-bot  | WARNING | 14-01-2026 00:53:42 | dispatcher.py:515 | Received SIGINT signal
7|duo-bot  | /var/www/duo/bot/autoshop/venv/lib/python3.12/site-packages/pydantic/_internal/_fields.py:149: UserWarning: Field "model_custom_emoji_id" has conflict with protected namespace "model_".
7|duo-bot  | 
7|duo-bot  | You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
7|duo-bot  |   warnings.warn(
7|duo-bot  | /var/www/duo/bot/autoshop/venv/lib/python3.12/site-packages/apscheduler/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg
_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
7|duo-bot  |   from pkg_resources import get_distribution, DistributionNotFound
7|duo-bot  | 
� Используется SERVER_URL: http://77.239.125.70:3000
7|duo-bot  | � PARTNER_API_SECRET установлен: ✅
7|duo-bot  | DB was found(1/8)
7|duo-bot  | DB was found(2/8)
7|duo-bot  | DB was found(3/8)
7|duo-bot  | DB was found(4/8)
7|duo-bot  | DB was found(5/8)
7|duo-bot  | DB was found(6/8)
7|duo-bot  | DB was found(7/8)
7|duo-bot  | DB was found(8/8)
7|duo-bot  | ~~~~~ Bot was started - @aasasdasdadsddasdbot ~~~~~
7|duo-bot  | ~~~~~ TG developer - @djimbox ~~~~~
7|duo-bot  | 
7|duo-bot  | ⚠️ Error sending photo: Telegram server says - Bad Request: invalid file HTTP URL specified: Disallowed character in URL host

DB was found(1/8)
7|duo-bot  | DB was found(2/8)
7|duo-bot  | DB was found(3/8)
7|duo-bot  | DB was found(4/8)
7|duo-bot  | DB was found(5/8)
7|duo-bot  | DB was found(6/8)
7|duo-bot  | DB was found(7/8)
7|duo-bot  | DB was found(8/8)
7|duo-bot  | ~~~~~ Bot was started - @aasasdasdadsddasdbot ~~~~~
7|duo-bot  | ~~~~~ TG developer - @djimbox ~~~~~
7|duo-bot  | 
7|duo-bot  | ⚠️ Error sending photo: Telegram server says - Bad Request: invalid file HTTP URL specified: Disallowed character in URL host

7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  |     from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  |     from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  |     from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  |     from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  |     from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  | 
7|duo-bot  | from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  | 
7|duo-bot  | from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  | 
7|duo-bot  | from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  |     from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  | 
7|duo-bot  | from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'
7|duo-bot  | Traceback (most recent call last):
7|duo-bot  |   File "/var/www/duo/bot/autoshop/main.py", line 8, in <module>
7|duo-bot  | 
7|duo-bot  | from aiogram.client.default import DefaultBotProperties
7|duo-bot  | ModuleNotFoundError: No module named 'aiogram.client.default'

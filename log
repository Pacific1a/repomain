root@duos:/var/www/duo/server# cd /var/www/duo/server && node scripts/clear-2fa.js &&      cd .. && pm2 restart duo-server
node:internal/modules/cjs/loader:1143
  throw err;
  ^

Error: Cannot find module '/var/www/duo/server/scripts/clear-2fa.js'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
    at Module._load (node:internal/modules/cjs/loader:981:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v18.20.8
root@duos:/var/www/duo/server# cd /var/www/duo/server
root@duos:/var/www/duo/server# node scripts/clear-2fa.js
node:internal/modules/cjs/loader:1143
  throw err;
  ^

Error: Cannot find module '/var/www/duo/server/scripts/clear-2fa.js'
    at Module._resolveFilename (node:internal/modules/cjs/loader:1140:15)
    at Module._load (node:internal/modules/cjs/loader:981:27)
    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:128:12)
    at node:internal/main/run_main_module:28:49 {
  code: 'MODULE_NOT_FOUND',
  requireStack: []
}

Node.js v18.20.8
root@duos:/var/www/duo/server#


root@duos:/var/www/duo# pm2 logs duo-server --lines 30
[TAILING] Tailing last 30 lines for [duo-server] process (change the value with --lines option)
/root/.pm2/logs/duo-server-error.log last 30 lines:
0|duo-serv |     at Route.dispatch (/var/www/duo/server/node_modules/express/lib/router/route.js:119:3)
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at /var/www/duo/server/node_modules/express/lib/router/index.js:284:15
0|duo-serv |     at Function.process_params (/var/www/duo/server/node_modules/express/lib/router/index.js:346:12)
0|duo-serv | ❌ Error enabling 2FA: TypeError: db.runAsync is not a function
0|duo-serv |     at /var/www/duo/server/routes/auth.routes.js:331:18
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at next (/var/www/duo/server/node_modules/express/lib/router/route.js:149:13)
0|duo-serv |     at jwtAuth (/var/www/duo/server/middleware/auth.js:31:9)
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at next (/var/www/duo/server/node_modules/express/lib/router/route.js:149:13)
0|duo-serv |     at Route.dispatch (/var/www/duo/server/node_modules/express/lib/router/route.js:119:3)
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at /var/www/duo/server/node_modules/express/lib/router/index.js:284:15
0|duo-serv |     at Function.process_params (/var/www/duo/server/node_modules/express/lib/router/index.js:346:12)
0|duo-serv | ❌ Error enabling 2FA: TypeError: db.runAsync is not a function
0|duo-serv |     at /var/www/duo/server/routes/auth.routes.js:331:18
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at next (/var/www/duo/server/node_modules/express/lib/router/route.js:149:13)
0|duo-serv |     at jwtAuth (/var/www/duo/server/middleware/auth.js:31:9)
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at next (/var/www/duo/server/node_modules/express/lib/router/route.js:149:13)
0|duo-serv |     at Route.dispatch (/var/www/duo/server/node_modules/express/lib/router/route.js:119:3)
0|duo-serv |     at Layer.handle [as handle_request] (/var/www/duo/server/node_modules/express/lib/router/layer.js:95:5)
0|duo-serv |     at /var/www/duo/server/node_modules/express/lib/router/index.js:284:15
0|duo-serv |     at Function.process_params (/var/www/duo/server/node_modules/express/lib/router/index.js:346:12)
0|duo-serv | ❌ Mines: No telegramId in socket handshake
0|duo-serv | ❌ BlackJack: No telegramId in socket handshake
0|duo-serv | ❌ Mines: No telegramId in socket handshake
0|duo-serv | ❌ BlackJack: No telegramId in socket handshake

/root/.pm2/logs/duo-server-out.log last 30 lines:
0|duo-serv | � Bot Username: @aasasdasdadsddasdbot
0|duo-serv | ========================================
0|duo-serv | 
0|duo-serv | � Bot static files: /var/www/duo/bot
0|duo-serv | � Partner site static files: /var/www/duo/site
0|duo-serv | � Uploads directory: /var/www/duo/site/uploads
0|duo-serv | ✅ Auth routes loaded
0|duo-serv | ✅ Referral routes loaded
0|duo-serv | ✅ Balance routes loaded
0|duo-serv | ✅ Transactions routes loaded
0|duo-serv | ✅ 2FA routes loaded (stubs)
0|duo-serv | ✅ Connected to SQLite database: ./data/database.db
0|duo-serv | ✅ Table [users] ready
0|duo-serv | ✅ Table [referral_stats] ready
0|duo-serv | ✅ Table [referrals] ready
0|duo-serv | ✅ Table [referral_events] ready
0|duo-serv | ✅ Database initialization complete
0|duo-serv | ✅ Database ready
0|duo-serv | ✅ Game handlers registered
0|duo-serv | ✅ Bot scheduler started
0|duo-serv | 
0|duo-serv | ========================================
0|duo-serv | ✅ SERVER IS RUNNING
0|duo-serv | ========================================
0|duo-serv | � Bot miniapp: http://localhost:3000/bot/
0|duo-serv | � Partner site: http://localhost:3000/partner/
0|duo-serv | � API: http://localhost:3000/api/
0|duo-serv | � Health: http://localhost:3000/health
0|duo-serv | ========================================
0|duo-serv | 

^C
root@duos:/var/www/duo#  cd /var/www/duo/server
root@duos:/var/www/duo/server# node migrations/add-2fa-columns.js
� Database path: /var/www/duo/server/data/database.db
� Running migration: Add 2FA columns to users table...
✅ Database connected
ℹ️  Column two_factor_secret already exists
ℹ️  Column two_factor_enabled already exists
root@duos:/var/www/duo/server#  pm2 restart duo-server
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [duo-server](ids: [ 0 ])
[PM2] [duo-server](0) ✓
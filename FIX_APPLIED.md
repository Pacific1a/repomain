# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:**
```
Error: /opt/render/project/src/server/node_modules/better-sqlite3/build/Release/better_sqlite3.node: invalid ELF header
```

‚úÖ **–†–µ—à–µ–Ω–∏–µ:**
- –£–¥–∞–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å `better-sqlite3` –∏–∑ `package.json`
- –§—É–Ω–∫—Ü–∏–∏ `getBotBalance()` –∏ `updateBotBalance()` –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∑–∞–≥–ª—É—à–∫–∏
- –°–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **JSON/MongoDB fallback** –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ —á—Ç–µ–Ω–∏—è SQLite

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### 1. `server/package.json`
```diff
- "better-sqlite3": "^12.4.6",
```

### 2. `server/server.js`
```javascript
// –ë—ã–ª–æ: –ø—Ä—è–º–æ–µ —á—Ç–µ–Ω–∏–µ SQLite —á–µ—Ä–µ–∑ better-sqlite3
- const Database = require('better-sqlite3');
- const db = new Database(BOT_DB_PATH);

// –°—Ç–∞–ª–æ: –∑–∞–≥–ª—É—à–∫–∏ —Å fallback –Ω–∞ JSON/MongoDB
function getBotBalance(telegramId) {
  console.log('‚ö†Ô∏è SQLite disabled on Render, using JSON/MongoDB fallback');
  return null; // –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JSON fallback
}
```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

### –ù–∞ Render:
```
1. getBotBalance() –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç null
2. –°–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É–µ—Ç JSON —Ñ–∞–π–ª (balances.json)
3. –ò–õ–ò MongoDB –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
```

### –õ–æ–∫–∞–ª—å–Ω–æ (Windows):
–¢–æ –∂–µ —Å–∞–º–æ–µ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è JSON —Ñ–∞–π–ª –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–≤

## –ü—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Render:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
‚ö†Ô∏è SQLite disabled on Render, using JSON/MongoDB fallback
üí∞ Balance loaded from JSON for 1889923046: 2400‚ÇΩ

# –í–º–µ—Å—Ç–æ:
‚ùå Error updating bot database: invalid ELF header
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç–∞:

1. **–í–∞—Ä–∏–∞–Ω—Ç 1: Bot API** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - –°–æ–∑–¥–∞—Ç—å HTTP API –≤ Python –±–æ—Ç–µ
   - –°–µ—Ä–≤–µ—Ä –±—É–¥–µ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ HTTP
   - –°–º. —Ñ–∞–π–ª—ã –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è

2. **–í–∞—Ä–∏–∞–Ω—Ç 2: Shared MongoDB**
   - –ò –±–æ—Ç –∏ —Å–µ—Ä–≤–µ—Ä –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É MongoDB
   - –ù—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –æ–±–æ–∏—Ö

3. **–í–∞—Ä–∏–∞–Ω—Ç 3: REST API —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
   - –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ POST –∑–∞–ø—Ä–æ—Å—ã
   - –°–µ—Ä–≤–µ—Ä —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞–µ—Ç –∏–∑ JSON/MongoDB

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

‚úÖ –û—à–∏–±–∫–∞ `invalid ELF header` **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞**  
‚úÖ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫  
‚úÖ –ë–∞–ª–∞–Ω—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ JSON —Ñ–∞–π–ª–µ  
‚ö†Ô∏è –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç–∞  

–î–ª—è –ø–æ–ª–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Bot API —Ä–µ—à–µ–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Ñ–∞–π–ª–æ–≤.

---

**–ì–æ—Ç–æ–≤–æ!** –°–µ—Ä–≤–µ—Ä —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫ –Ω–∞ Render.
